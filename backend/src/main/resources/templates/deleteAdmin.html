<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/layoutReal}">
<head>
    <style>
        /* 관리자 삭제 페이지 스타일 */

body {
    font-family: 'Arial', sans-serif;
    background-color: #f4f4f4;
    margin: 0;
    padding: 0;
}

.content {
    max-width: 800px;
    margin: 40px auto;
    padding: 20px;
    background-color: #ffffff;
    border-radius: 10px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
}

table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 20px;
}

table th, table td {
    padding: 12px;
    text-align: left;
    border-bottom: 1px solid #ddd;
}

table th {
    background-color: #2c3e50;
    color: #ffffff;
}

button {
    padding: 10px 15px;
    background-color: #e74c3c;
    color: #ffffff;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    transition: background-color 0.3s ease;
}

button:hover {
    background-color: #c0392b;
}

a {
    text-decoration: none;
    color: #3498db;
    margin-left: 90%;
}

a:hover {
    text-decoration: underline;
}

/* 반응형 디자인 */
@media (max-width: 600px) {
    .content {
        padding: 10px;
    }
    table th, table td {
        padding: 8px;
    }
    button {
        width: 100%;
        margin-top: 10px;
    }
    a {
        display: block;
        margin-top: 10px;
    }
}

    </style>
</head>
<body>
<div layout:fragment="content" class="content">
    <section>
        <table>
            <thead>
            <tr>
                <th>이메일</th>
                <th>이름</th>
                <th>전화번호</th>
                <th>역할</th>
                <th>관리</th>
            </tr>
            </thead>
            <tbody>
            <!-- ADMIN 역할의 사용자만 목록에 표시 -->
            <tr th:each="user : ${users}">
                <td th:text="${user.userEmail}"></td>
                <td th:text="${user.userName}"></td>
                <td th:text="${user.userPhone}"></td>
                <td th:text="${user.userRole}"></td>
                <td>
                    <button
                            th:onclick="'deleteAdmin(' + ${user.userId} + ')'"
                            type="button">
                        관리자 삭제
                    </button>
                    <script th:inline="javascript">
                        function deleteAdmin(userId) {
                            if (confirm("정말로 이 관리자를 삭제하시겠습니까?")) {
                                fetch(`/admin/deleteAdmin/${userId}`, {
                                    method: 'DELETE'
                                })
                                .then(response => {
                                    if (response.ok) {
                                        alert('관리자가 삭제되었습니다.');
                                        window.location.reload();
                                    } else {
                                        alert('삭제 중 오류가 발생했습니다.');
                                    }
                                })
                                .catch(error => {
                                    console.error('Error:', error);
                                    alert('오류가 발생했습니다.');
                                });
                            }
                        }
                    </script>
                </td>
            </tr>
            </tbody>
        </table>
        <div>
            <a href="userList">돌아가기</a>
        </div>
    </section>
</div>
</body>
</html>